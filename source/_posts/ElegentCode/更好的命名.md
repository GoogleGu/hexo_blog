---
title: 更好的命名
date: 2019-11-27 19:09:41
tags:
    - readability
---

## 1.为什么需要好名字

### 名字即为注释

名字起到的作用其实是一种短小的注释，与注释不同的是，一个好的名字会在多个他被用到的地方起到解释说明的地方，变量名、方法名、类名等在被引用调用时都会起到注释的作用，因此一个好的名字比注释更为重要。

### 节省时间

挑选一个好名字确实是需要时间的，但是选名字花的时间要远远少于之后因为名字混乱而浪费的时间。
<!-- more -->

## 2. 准确的名字

### 意义准确

在起名字的时候尽量使用意义准确的名字，不要使用那些含义十分含混的名字。

- 诸如evil、bad、good、holy等形容词很多时候其实是意义不明的，何为好？何为坏？如果重复为坏，不如命名为duplicated，如果有额外的空格为坏，不如取名为extra_spaced。
- 一个终止线程的方法名可能为stop，如果该线程终止后无法重启，那么起名为kill明显更准确，如果可以重启，那么pause显然更能说明这个方法在干什么。
- 另一个常见的例子是在二叉树对象中，通常有个字段名为size表示大小，那么这个size到底是表示树的层高height，还是节点数量num_nodes，还是内存用量memory_bytes呢？
- get这个动词经常会被滥用，如果是从网络上下载网页信息的，应该描述为download，如果是从数据库中读取，或许应该是query，如果真的是进行一个很简单的内存读取操作，那么这时才应该叫get。

### 不要使用个人色彩浓烈的名字 

要使用一些自以为有趣或别出心裁的名字，kill_them_all的含义就不如delete_all来的清楚，heroes_never_die也不如restart_stuck_thread来得好。

### 添加语境

如果有什么读代码的人非常需要了解的信息，那么可以在名字上多加一个词。

- 这样的词可以是时间单位：比如说一段记录用户操作时间的变量，若其单位为分钟，只命名为user_operation_time可能会让人产生误会为分钟，但是user_operation_time_min可能就要更清晰一些。
- 也可以是加密与否：plaintext_password，encoded_password。
- 编码格式：utf8_page，gbk_page。
- 还可以是一些和变量名主体相关的语境信息：如果有一组名为city, state, zipcode的变量，他们同时出现时意义尚且明显，不需要额外的信息加入其中，但是如果有某个地方单独用到state，那么这个state到底是国家的意思还是状态的意思呢？加上address变为address_state就比较好了。（所以说要加入信息到什么程度也是相对而言的，这个后面再说）

### 避免过于泛化的名字

tmp、retval这样的名字一再地出现其实只说明了一个问题：写这段代码的程序员太懒了，以至于不愿去想一个合适的名字而是直接使用了脑海中蹦出来的第一个随处可见的名字。

- retval可以用描述变量数值的名字来替代
- tmp则可以用描述临时变量数值的名字来代替。如果tmp真的只是在很短的三四行代码中作为一个临时变量使用，那么确实可以使用，如果是别的情形，最好还是给它起个直白有意义的名字吧。

在循环的时候i, j, k这样的名字常用来描述循环中的计数，如果只是单层循环的话用i是毫无问题的，但是一旦有嵌套的话，最好把循环层的信息加到名字中，比如club_i, members_i, users_i这样，否则代码会变成一锅乱粥难以卒读。

## 3. 一致的命名

除了命名意义要准确以外，有一些通用的命名格式和规则，可以有效减少名字导致的混乱。

### 代码规范

最最基本的，名字应当符合代码规范，不论是驼峰还是全大写还是小写加下划线格式，只有符合代码规范的名字才是好名字，因为这些格式都对应着一定的含义，不遵守规范格式起出的名字必然会让别人阅读你的代码时产生疑惑和混乱。

### 类名与对象名

类和对象的名字应该为名词，不能是动词。

### 方法名

方法的名字应该是动词或动词短语，属性访问器、修改器、判断器应该加上get，set，is前缀。

### 布尔值

按照特定的逻辑场合，布尔值变量前加上is, has, can, should往往能够更好地识别布尔值和提高可读性。

### 每个概念对应一个名字

为每个框架中常见的概念设计一个合适的名字，并且在之后的代码中以一贯之地实行下去。这样的话以后看到这个名字就能大概了解这个名字对应的概念和职能。
举个例子，如果涉及到数据库查找的方法可以全部起名为query_xx，所有的数据库记录映射对象可以起名为xx_record。又如java里的controller其实就是一个概念对应的例子。

### 使用业界通用的术语

由于我们写的代码是给程序员看的，所以使用编程界通用的术语往往可以剩下很大的力气，并且可以起出准确简洁的名字。
对于了解单例的程序员来说，SingletonPrinter绝对要比TheOnlyOnePrinter要来的清楚；MessageCache绝对要比LocalDataCopyOfMessage要清楚简洁的多。

## 4. 名字的长度

之前我们一直在说要向名字中加入足够多的信息，这个过程中不可避免地让名字变长，但是过长的名字也会损害可读性，一个类似于AbsoluteShipScheduleEstimatedDepatureDateTemplateParsingMatcher是很难搞清楚它到底是在描述什么的。因此我们要在信息准确和控制长度之间做好平衡。

### 去除冗余

有一些名字中的一些词语其实是含混不清或者没有提供太多额外信息的，这样的冗余词语完全可以抛弃掉，从而缩短名字的长度。比如info、data、value等这样的词语其实没有传达什么额外的信息，可以从名字中弃除。

### 根据变量的位置决定名字长短

如果一个变量的作用域很小，那么一个简短一些不包含所有信息的名字也够用了；但是如果一个变量要在上下100行的定义域跨度中被使用，它的名字就可以被适当地长一些，因为如果包含的信息不够的话，看到其作用域后半部分的时候很可能已经搞不清楚这个变量到底是做什么的了。
所以说变量的名字长短不是绝对的，在保证信息足够的情况下，名字应该尽量短，但也不应为了缩短名字而丢弃名字中必要的信息。

## 5. 持续修改

在很多时候，经过代码的重构、新需求的改写填充之后，原来准确有效的命名会变得逐渐失去意义、易于混淆，这是一个必然的过程，这就要求我们在重构代码的时候也要注意命名的问题，如果发现因为代码结构或逻辑的改变而导致某些名字变得不那么好了，一定要在改动的同时就把名字一并修改，这样才能保证代码质量逐步提高而不是渐次下降。
